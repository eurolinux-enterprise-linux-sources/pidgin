diff -up pidgin-2.7.9/libpurple/stun.c.CVE-2013-6484 pidgin-2.7.9/libpurple/stun.c
--- pidgin-2.7.9/libpurple/stun.c.CVE-2013-6484	2010-10-16 23:43:27.000000000 -0400
+++ pidgin-2.7.9/libpurple/stun.c	2014-01-29 10:45:58.592624169 -0500
@@ -175,7 +175,7 @@ static void reply_cb(gpointer data, gint
 	struct sockaddr_in *sinptr;
 
 	len = recv(source, buffer, sizeof(buffer) - 1, 0);
-	if (!len) {
+	if (len < 0) {
 		purple_debug_warning("stun", "unable to read stun response\n");
 		return;
 	}
