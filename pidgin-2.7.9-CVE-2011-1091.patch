diff -up pidgin-2.7.9/libpurple/protocols/yahoo/libymsg.c.CVE-2011-1091 pidgin-2.7.9/libpurple/protocols/yahoo/libymsg.c
--- pidgin-2.7.9/libpurple/protocols/yahoo/libymsg.c.CVE-2011-1091	2010-10-16 23:58:01.000000000 -0400
+++ pidgin-2.7.9/libpurple/protocols/yahoo/libymsg.c	2011-03-11 10:34:48.929061085 -0500
@@ -842,7 +842,7 @@ static void yahoo_process_notify(PurpleC
 				break;
 		}
 
-		if (*stat == '1')
+		if (stat && *stat == '1')
 			serv_got_typing(gc, fed_from, 0, PURPLE_TYPING);
 		else
 			serv_got_typing_stopped(gc, fed_from);
@@ -864,7 +864,7 @@ static void yahoo_process_notify(PurpleC
 
 		yahoo_friend_set_game(f, NULL);
 
-		if (*stat == '1') {
+		if (stat && *stat == '1') {
 			yahoo_friend_set_game(f, game);
 			if (bud)
 				yahoo_update_status(gc, from, f);
@@ -922,6 +922,11 @@ static void yahoo_process_sms_message(Pu
 		l = l->next;
 	}
 
+	if(!sms) {
+		purple_debug_info("yahoo", "Received a malformed SMS packet!\n");
+		return;
+	}
+
 	if( (pkt->status == -1) || (pkt->status == YAHOO_STATUS_DISCONNECTED) ) {
 		if (server_msg) {
 			PurpleConversation *c;
